<template>
  <style>
    .prefs-panel {
      font-family: var(--term-sans);
      background: var(--term-bg);
      color: var(--term-text);
    }

    .prefs-inner {
      display: flex;
      flex-direction: column;
      height: 100%;
      overflow: hidden;
    }

    .prefs-header {
      padding: 16px 20px;
    }

    .prefs-header h1 {
      margin: 0;
      font-family: var(--term-mono);
      font-size: 16px;
      font-weight: 600;
      letter-spacing: 0.05em;
      color: var(--term-accent);
      text-transform: uppercase;
    }

    .prefs-content {
      flex: 1;
      min-height: 0;
      overflow-y: auto;
      padding: 20px;
    }

    .prefs-section {
      margin-bottom: 24px;
    }

    .prefs-section h2 {
      margin: 0 0 12px 0;
      font-family: var(--term-mono);
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      color: var(--term-text-dim);
      padding-left: 12px;
      border-left: 3px solid var(--term-border);
    }

    .theme-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    /* Theme item styles (from list-item viewdef) */
    .theme-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 16px;
      background: var(--term-bg-elevated);
      border: 1px solid var(--term-border);
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.15s;
    }

    .theme-item:hover {
      border-color: var(--term-accent);
      background: var(--term-bg-hover);
    }

    .theme-item.selected {
      border-color: var(--term-accent);
      background: linear-gradient(90deg, var(--term-accent-dim) 0%, transparent 100%);
      border-left: 4px solid var(--term-accent);
      padding-left: 12px;
    }

    .theme-radio {
      flex-shrink: 0;
      width: 18px;
      height: 18px;
      border: 2px solid var(--term-border);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.15s;
    }

    .theme-item.selected .theme-radio {
      border-color: var(--term-accent);
    }

    .theme-radio-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--term-accent);
      transform: scale(0);
      transition: transform 0.15s;
    }

    .theme-item.selected .theme-radio-dot {
      transform: scale(1);
    }

    .theme-info {
      flex: 1;
      min-width: 0;
    }

    .theme-name {
      font-family: var(--term-mono);
      font-size: 14px;
      font-weight: 600;
      color: var(--term-text);
      margin-bottom: 2px;
    }

    .theme-description {
      font-size: 12px;
      color: var(--term-text-dim);
    }

    .theme-swatch {
      flex-shrink: 0;
      width: 32px;
      height: 20px;
      border-radius: 4px;
      border: 1px solid var(--term-border);
    }
  </style>

  <div class="prefs-panel">
    <div class="prefs-inner">
      <div class="prefs-header panel-header">
        <h1>Preferences</h1>
      </div>

      <div class="prefs-content">
        <div class="prefs-section">
          <h2>Updates</h2>
          <div style="display: flex; align-items: center; gap: 16px;">
            <sl-checkbox ui-attr-checked="checkUpdates()" ui-event-sl-change="toggleCheckUpdates()">
              Check for updates on startup
            </sl-checkbox>
            <sl-button size="small" ui-action="checkNow()">Check Now</sl-button>
          </div>
        </div>

        <div class="prefs-section">
          <h2>Tutorial</h2>
          <sl-button size="small" variant="default" ui-action="startTutorial()">
            <sl-icon name="mortarboard" slot="prefix"></sl-icon>
            Run Tutorial
          </sl-button>
        </div>

        <div class="prefs-section" ui-class-hidden="themesHidden()">
          <h2>Themes</h2>
          <div class="theme-list" ui-view="themes()?wrapper=lua.ViewList"></div>
        </div>
      </div>

    </div>
  </div>

  <script>
    (function() {
      const panel = document.querySelector('.prefs-inner');
      if (!panel) return;

      panel.applyTheme = function(name) {
        document.documentElement.className = 'theme-' + name;
        // Mirror to localStorage so index.html can apply theme instantly on page load
        localStorage.setItem('theme', name);
      };
    })();
  </script>
  <script>document.getElementById('app-favicon').href='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0iI0UwN0E0NyIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICA8cGF0aCBkPSJNOCA0Ljc1NGEzLjI0NiAzLjI0NiAwIDEgMCAwIDYuNDkyIDMuMjQ2IDMuMjQ2IDAgMCAwIDAtNi40OTJNNS43NTQgOGEyLjI0NiAyLjI0NiAwIDEgMSA0LjQ5MiAwIDIuMjQ2IDIuMjQ2IDAgMCAxLTQuNDkyIDAiLz4KICA8cGF0aCBkPSJNOS43OTYgMS4zNDNjLS41MjctMS43OS0zLjA2NS0xLjc5LTMuNTkyIDBsLS4wOTQuMzE5YS44NzMuODczIDAgMCAxLTEuMjU1LjUybC0uMjkyLS4xNmMtMS42NC0uODkyLTMuNDMzLjkwMi0yLjU0IDIuNTQxbC4xNTkuMjkyYS44NzMuODczIDAgMCAxLS41MiAxLjI1NWwtLjMxOS4wOTRjLTEuNzkuNTI3LTEuNzkgMy4wNjUgMCAzLjU5MmwuMzE5LjA5NGEuODczLjg3MyAwIDAgMSAuNTIgMS4yNTVsLS4xNi4yOTJjLS44OTIgMS42NC45MDEgMy40MzQgMi41NDEgMi41NGwuMjkyLS4xNTlhLjg3My44NzMgMCAwIDEgMS4yNTUuNTJsLjA5NC4zMTljLjUyNyAxLjc5IDMuMDY1IDEuNzkgMy41OTIgMGwuMDk0LS4zMTlhLjg3My44NzMgMCAwIDEgMS4yNTUtLjUybC4yOTIuMTZjMS42NC44OTMgMy40MzQtLjkwMiAyLjU0LTIuNTQxbC0uMTU5LS4yOTJhLjg3My44NzMgMCAwIDEgLjUyLTEuMjU1bC4zMTktLjA5NGMxLjc5LS41MjcgMS43OS0zLjA2NSAwLTMuNTkybC0uMzE5LS4wOTRhLjg3My44NzMgMCAwIDEtLjUyLTEuMjU1bC4xNi0uMjkyYy44OTMtMS42NC0uOTAyLTMuNDMzLTIuNTQxLTIuNTRsLS4yOTIuMTU5YS44NzMuODczIDAgMCAxLTEuMjU1LS41MnptLTIuNjMzLjI4M2MuMjQ2LS44MzUgMS40MjgtLjgzNSAxLjY3NCAwbC4wOTQuMzE5YTEuODczIDEuODczIDAgMCAwIDIuNjkzIDEuMTE1bC4yOTEtLjE2Yy43NjQtLjQxNSAxLjYuNDIgMS4xODQgMS4xODVsLS4xNTkuMjkyYTEuODczIDEuODczIDAgMCAwIDEuMTE2IDIuNjkybC4zMTguMDk0Yy44MzUuMjQ2LjgzNSAxLjQyOCAwIDEuNjc0bC0uMzE5LjA5NGExLjg3MyAxLjg3MyAwIDAgMC0xLjExNSAyLjY5M2wuMTYuMjkxYy40MTUuNzY0LS40MiAxLjYtMS4xODUgMS4xODRsLS4yOTEtLjE1OWExLjg3MyAxLjg3MyAwIDAgMC0yLjY5MyAxLjExNmwtLjA5NC4zMThjLS4yNDYuODM1LTEuNDI4LjgzNS0xLjY3NCAwbC0uMDk0LS4zMTlhMS44NzMgMS44NzMgMCAwIDAtMi42OTItMS4xMTVsLS4yOTIuMTZjLS43NjQuNDE1LTEuNi0uNDItMS4xODQtMS4xODVsLjE1OS0uMjkxQTEuODczIDEuODczIDAgMCAwIDEuOTQ1IDguOTNsLS4zMTktLjA5NGMtLjgzNS0uMjQ2LS44MzUtMS40MjggMC0xLjY3NGwuMzE5LS4wOTRBMS44NzMgMS44NzMgMCAwIDAgMy4wNiA0LjM3N2wtLjE2LS4yOTJjLS40MTUtLjc2NC40Mi0xLjYgMS4xODUtMS4xODRsLjI5Mi4xNTlhMS44NzMgMS44NzMgMCAwIDAgMi42OTItMS4xMTV6Ii8+Cjwvc3ZnPgo='</script>
</template>
